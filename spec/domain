# vim:ft=Marchfile

@Table "user.user"
User entity {

    @ID
    ID int

    Name string

    @Validate "email"
    Email string

    @Validate "regex:[a-zA-Z0-9]"
    Login string

    @Hash
    @Hidden
    Password string

    @Column "is_admin"
    IsAdmin bool

    @JSON
    Address {
        Phone string
        Address string
    }

    @JSON
    Metadata {
        LastLogin timestamp
    }

    @OneToMany
    Groups []Group

    @OneToMany
    Permissions []Permission
}

@Table "user.group"
Group entity {
    @ID
    ID int

    Name string
}

@Table "user.permission"
Permission entity {
    @ID
    ID int

    Name string
}

@View "User"
UserCreateRequest view {
    Name
    Email

    @Bind "Login"
    Username

    Address
}

@View "User"
UserUpdateRequest view {
    Name
    Email
    Address
}
