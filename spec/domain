# vim:ft=Marchfile

@Entity "user.user"
domain User {

    @ID
    ID int

    Name string

    @Validate "email"
    Email string

    @Validate "regex:[a-zA-Z0-9]"
    Login string

    @Hash
    @Hidden
    Password string

    @Column "is_admin"
    IsAdmin bool

    @JSON
    Address {
        Phone string
        Address string
    }

    @JSON
    Metadata {
        LastLogin timestamp
    }

    @OneToMany
    Groups []Group

    @OneToMany
    Permissions []Permission
}

@Entity "user.group"
domain Group {
    @ID
    ID int

    Name string
}

@Entity "user.permission"
domain Permission {
    @ID
    ID int

    @Column
    Name string
}

@View "User"
domain UserCreateRequest {
    Name
    Email

    @Bind "Login"
    Username

    Address
}

@View "User"
domain UserUpdateRequest {
    Name
    Email
    Address
}
